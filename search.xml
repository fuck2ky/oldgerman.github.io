<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>esp8266 4线风扇调速测速</title>
      <link href="/f3fd3c5b/"/>
      <url>/f3fd3c5b/</url>
      
        <content type="html"><![CDATA[<h2 id="1-主板4针风扇接口"><a class="header-anchor" href="#1-主板4针风扇接口">¶</a>1.主板4针风扇接口</h2><p>先从一张年代久远的图说起，听说是intel的规范，2003年的，</p><p>给出了了主板4针风扇接口的外围电路设计，咱就参考这个测试：</p><p><img src="/f3fd3c5b/%E8%8B%B1%E7%89%B9%E5%B0%94%E4%B8%BB%E6%9D%BF%E9%A3%8E%E6%89%87-4pin%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83.png" alt="英特尔主板风扇 4pin设计规范"></p><h3 id="目前4pin接口主流的线序"><a class="header-anchor" href="#目前4pin接口主流的线序">¶</a>目前4pin接口主流的线序</h3><p>😥啊诺呐，和上图有点不一样，看仔细了</p><table><thead><tr><th style="text-align:center">引脚编号</th><th style="text-align:center">导线颜色</th><th style="text-align:center">引线定义</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">黑</td><td style="text-align:center">GND</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">红</td><td style="text-align:center">+12V</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">黄</td><td style="text-align:center">测速线</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">蓝</td><td style="text-align:center">调速线</td></tr></tbody></table><h2 id="2-电路分析"><a class="header-anchor" href="#2-电路分析">¶</a>2.电路分析</h2><h4 id="1-2号引脚"><a class="header-anchor" href="#1-2号引脚">¶</a>1，2号引脚</h4><p>负责风扇供电，风扇是外转子无刷电机，没有机械式换向器(使用半导体换向器)，因此不会产生碳刷交替时的电压，所以Intel只并一个铝电解电容对电源进行低频滤波，不知道这样理解对不对?</p><h4 id="3号引脚"><a class="header-anchor" href="#3号引脚">¶</a>3号引脚</h4><p>输出风扇转速，用4.7k上拉到12V电源，再接27.4k和10k两个电阻分压，<code>FAN TACH</code>测速线从10k分压测量脉冲信号，粗略计算一下，<code>FAN TACH</code>的高电平为2.85V，匹配3.3V系统的逻辑电平，所以esp8266的GPIO引脚可以测量</p><p>😳为什么肯定3号线输出的是电平信号而不是模拟电压？</p><p>题主没有示波器，调节4线风扇的转速时，先没有用3号引脚的外围电路，直接用万用表测量3号引脚，其电压范围差不多0.02V~0.18V，推测这个引脚不能输出高电平但有内部上拉电阻，接着搭建了外围电路，在<code>FAN TACH</code>位置进行测量，发现无论怎样调速，电压保持1.51V左右不变，假设为电平信号计算的高电平为2.85V，那么可以肯定该引脚输出一个占空比约为50%，频率随转速变化的TTL信号</p><h4 id="4号引脚"><a class="header-anchor" href="#4号引脚">¶</a>4号引脚</h4><p>调节风扇的转速，使用NPN晶体管，型号<a href="https://pdf1.alldatasheet.com/datasheet-pdf/view/17919/PHILIPS/MMBT3904.html" target="_blank" rel="noopener">MMBT3904</a>，40V 100mA，集电极和发射极串接两个4.7k限流</p><h2 id="3-测试准备"><a class="header-anchor" href="#3-测试准备">¶</a>3.测试准备</h2><h4 id="原理图"><a class="header-anchor" href="#原理图">¶</a>原理图</h4><p><img src="/f3fd3c5b/sch.png" alt></p><p>开发板为NodeMCU 1.0 ESP-12E</p><p>R7为10k电位器，接入A0读取模拟量</p><p>T1为三极管，用2N222A代替，参数40V 600mA，集电极限流电阻建议1-4.7k</p><p>C1为滤波电容，推荐钽电容或铝电解</p><p>英特尔的图27.4k用R4 20k和R5 6.8k代替，合计26.8k，FAN_SPEED高电平增加到2.89V</p><p>12V电源和开发板必须共地，否则三极管不能正常开关，无法调速</p><h4 id="nodemcu-1-0-可产生pwm信号的引脚"><a class="header-anchor" href="#nodemcu-1-0-可产生pwm信号的引脚">¶</a>NodeMCU 1.0 可产生PWM信号的引脚</h4><p>上图中，标有“正弦波”的引脚可产生PWM信号，实际上D0也可以</p><h4 id="面包板搭建电路"><a class="header-anchor" href="#面包板搭建电路">¶</a>面包板搭建电路</h4><p><img src="/f3fd3c5b/%E9%9D%A2%E5%8C%85%E6%9D%BF.JPG" alt></p><h2 id="4-安利vmicro"><a class="header-anchor" href="#4-安利vmicro">¶</a>4.安利vMicro</h2><p>visual studo的arduino ide马甲程序，除了支持原版的所有功能，外加vs的标配功能，例如实时代码纠错，参数列表，自动补全，自动加载函数，等等，实在审美不了原版万年的蓝绿色，另外用vs写程序更专业😢</p><h4 id="如何安装"><a class="header-anchor" href="#如何安装">¶</a>如何安装</h4><p>在vs拓展管理中搜索arduino安装即可，使用教程网上很多，这里不做复述</p><p><img src="/f3fd3c5b/vMcrio.png" alt></p><h2 id="5-示例代码"><a class="header-anchor" href="#5-示例代码">¶</a>5.示例代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Name:Blink_and_Pwm.ino</span></span><br><span class="line"><span class="comment"> Created:2020/2/18 12:29:16</span></span><br><span class="line"><span class="comment"> Author:OldGerman</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Ticker.h"</span></span></span><br><span class="line">Ticker timer1;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  pins</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> analogInPin = A0;     <span class="comment">//  A0 读取电位器电压</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> fan_speed = <span class="number">12</span>;       <span class="comment">//  D6 测速</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pwm_out = <span class="number">16</span>;         <span class="comment">//  D0 调速</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// other message</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> duration = <span class="number">0</span>;     <span class="comment">//  加权时间</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> read_times = <span class="number">2</span>;       <span class="comment">//  测速信号采样周期（多取几次可更精确）</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> fan_min_Hz = <span class="number">40</span>;      <span class="comment">//  测速线每秒最低脉冲次数，不同的风扇不一样，需要根据转速范围计算，或者实测也行</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwm</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Pwm(<span class="keyword">int</span> pin)</span><br><span class="line">        : _pin(pin)</span><br><span class="line">    &#123;   pinMode(_pin, OUTPUT);  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pwmWrite</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;   analogWrite(_pin, outputValue());   &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> sensorValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">outputValue</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        sensorValue = analogRead(analogInPin);  <span class="comment">//  esp8266 ADC为10位，analogRead()范围0~1023</span></span><br><span class="line">        <span class="keyword">return</span> sensorValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> _pin;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Pwm::sensorValue = <span class="number">0</span>;   <span class="comment">//  外部初始化静态类成员</span></span><br><span class="line"><span class="function">Pwm <span class="title">pwm</span><span class="params">(pwm_out)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">class_pwm</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pwm.pwmWrite();</span><br><span class="line"></span><br><span class="line">    Serial.print(<span class="string">"ADC: "</span>);</span><br><span class="line">    Serial.print(Pwm::sensorValue);</span><br><span class="line">    Serial.print(<span class="string">' '</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_speed</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    duration = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (Pwm::sensorValue &lt; <span class="number">720</span>) &#123;                   <span class="comment">//  当风扇开始转动时，计算转速</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; read_times; i++) &#123;      <span class="comment">//  对高低电平的变化时间加权计算，得出总时间，单位: ms</span></span><br><span class="line">            duration += pulseIn(fan_speed, HIGH);   <span class="comment">//  pulseIn()默认等待超时时间1000000UL，等待过长会使硬件看门狗复位</span></span><br><span class="line">            duration += pulseIn(fan_speed, LOW);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        duration = <span class="number">4294967295</span>;          <span class="comment">//  sensorValue = 1023 风扇会停止输出脉冲信号，pulseIn()会一直等待电平变化，导致复位</span></span><br><span class="line">                                        <span class="comment">//      设置为unsigned long类型的最大值，让计算后风扇转速接近为0</span></span><br><span class="line">    &#125;</span><br><span class="line">    duration = duration / read_times;           <span class="comment">//  高低电平变化1次用时,单位: ms</span></span><br><span class="line">    duration = <span class="number">1000000</span> / duration;              <span class="comment">//  1秒内产生的脉冲次数（风扇转速，单位: Hz）</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(duration &lt; fan_min_Hz)                   <span class="comment">//  计算值小于最低每秒脉冲数，直接取最小值</span></span><br><span class="line">        duration = fan_min_Hz;</span><br><span class="line">    </span><br><span class="line">    Serial.print(duration);</span><br><span class="line">    Serial.print(<span class="string">" HZ"</span>);</span><br><span class="line">    duration = duration * <span class="number">60</span>;                   <span class="comment">//  1分钟内可变化几次（风扇转速: r/min）</span></span><br><span class="line">    Serial.print(<span class="string">"  v is "</span>);</span><br><span class="line">    Serial.print(duration);</span><br><span class="line">    Serial.println(<span class="string">" r/min"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">all_loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    class_pwm();</span><br><span class="line">    read_speed();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-------------------------------------MAIN FUNCTION-------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Serial.begin(<span class="number">115200</span>); </span><br><span class="line"></span><br><span class="line">    <span class="comment">/*定时器不能设置两个相同的定时任务，会导致硬件看门狗复位*/</span></span><br><span class="line">    <span class="comment">//timer2.attach_ms(100, class_pwm);</span></span><br><span class="line">    <span class="comment">//timer2.attach_ms(100, read_speed);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*将上述两函数打包进一个函数内先后调用*/</span></span><br><span class="line">    timer1.attach_ms(<span class="number">200</span>, all_loop);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure><h2 id="6-demo"><a class="header-anchor" href="#6-demo">¶</a>6.Demo</h2><p>打开串口监视器，调节点位器控制风扇转速，输出如下：</p><p><img src="/f3fd3c5b/change_speed.png" alt></p><h2 id="7-有关代码的疑问"><a class="header-anchor" href="#7-有关代码的疑问">¶</a>7.有关代码的疑问</h2><h4 id="第35行-analogread-返回值范围"><a class="header-anchor" href="#第35行-analogread-返回值范围">¶</a>第35行，<code>analogRead()</code>，返回值范围</h4><p>esp8266内置10位ADC，所以该函数返回范围0-1023，对于Arduino开发板例如Uno，该函数返回0-255</p><h4 id="第56行-sensorvalue-720-为什么不是1023？"><a class="header-anchor" href="#第56行-sensorvalue-720-为什么不是1023？">¶</a>第56行，<code>sensorValue &lt; 720</code>，为什么不是1023？</h4><p>一般来说，12V风扇的最低转速不为0，例如猫头鹰的NF-12，其转速范围300-1500rpm，题主测试用的4010风扇，转速范围2400-128400左右，实测从A0读取的值大于720时，继续旋转电位器增大读数，风扇测速线的脉冲频率在40Hz左右不变，所以，可以认为在720时，风扇已经降至最低转速，继续减小esp8266输出的pwm占空比，并不会使风扇继续降速，如图：</p><p><img src="/f3fd3c5b/2400rpm++.png" alt></p><h4 id="若继续增大到1023-会导致看门狗复位"><a class="header-anchor" href="#若继续增大到1023-会导致看门狗复位">¶</a>若继续增大到1023，会导致看门狗复位</h4><p>众所周知，esp8266不能像Arduino那样长时间执行循环，实测当跳到1023左右时，风扇的测速线不再输出脉冲信号，因为我们在for循环中调用了多次<code>pulseIn()</code>，该函数默认等待超时时间为1秒，测速线停止输出脉冲，<code>pulseIn()</code>每次都等待1秒，超时触发看门狗，复位瞬间：</p><p><img src="/f3fd3c5b/wdt_reset.png" alt></p><h4 id="第17行-read-times取多少合适？"><a class="header-anchor" href="#第17行-read-times取多少合适？">¶</a>第17行，<code>read_times</code>取多少合适？</h4><p>😳首先，题主esp8266运行主频80Mhz，在160Mhz时<code>pulseIn()</code>的处理可能更快</p><p>read_times示例程序中取2，使第57行<code>for</code>迭代2次，每一次迭代调用了2次<code>pulseIn()</code>，那么循环一共调用了4次<code>pulseIn</code>，在<code>setup()</code>中，我们使用Ticker对象调用<code>attach_ms()</code>每200ms调用<code>read_speed()</code>，因此，多次调用<code>pulseIn()</code>总共等待的时间最多为200ms，题主使用的4010风扇最低脉冲频率为40Hz，即每1000ms产生40个脉冲周期，每个脉冲周期25ms，所以理想情况下，每25ms正好触发2次<code>pulseIn()</code></p><p><strong>然而，程序执行函数时处理也需要时间，实际上每25ms执行次数小于1：</strong></p><p>当我把 read_times取5时，40Hz时极易发生看门狗复位，此时每200ms <code>for</code>执行10次<code>pulseIn()</code>，也就是说10次耗费时间超过了200ms致使esp8266没有喘气的时间，这时定时器任务可以认为是一个死循环，说明每次执行<code>pulseIn()</code>的时间大于20ms，所以25ms只能触发约一次该函数的调用😮</p><p>另外，还要考虑 <code>class_pwm()</code>的处理耗时，题主认为read_times取3，即每200ms调用6次最坏情况总计150ms已经很极限，so，我取了2，每200ms调用4次最坏情况总计100ms</p><p>总之，这个值得根据风扇计算，对于猫头鹰NF-12，最低每秒5Hz，即每脉冲周期长达200ms，那么相应地延长<code>Ticker</code>的定时周期，以降低<code>read_speed()</code>的调用频率，也是不错的选择😃</p><h2 id="8-参考文献"><a class="header-anchor" href="#8-参考文献">¶</a>8.参考文献</h2><p><a href="https://www.cnblogs.com/kekeoutlook/p/8292444.html" target="_blank" rel="noopener">Arduino环境esp8266 pwm函数使用</a></p><p><a href="https://blog.csdn.net/qq_31077649/article/details/72581968" target="_blank" rel="noopener">pulseIn() 函数的使用方法-超声波测距</a></p><p><a href="http://club.gizwits.com/thread-3767-1-1.html" target="_blank" rel="noopener">esp8266 的看门狗有什么作用?</a></p><p><a href="https://www.arduino.cn/forum.php?mod=viewthread&amp;tid=83602&amp;mobile=no" target="_blank" rel="noopener">特别感谢Arduino论坛：skyhome 提供的思路</a></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp8266 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小娱C5_配置篇</title>
      <link href="/29c16836/"/>
      <url>/29c16836/</url>
      
        <content type="html"><![CDATA[<h2 id="1-更改ip地址-可选"><a class="header-anchor" href="#1-更改ip地址-可选">¶</a>1. 更改IP地址|可选</h2><p>检查你使用的网络环境，如果某些设备的IP地址与老毛子固件默认的IP地址<code>192.168.123.1</code>一样</p><p>请修改<code>192.168.123.1</code>中的<code>123</code>为0~254任意数值</p><p><em>滑动到页面底部，点击</em><em>应用本页面设置</em>*</p><p><img src="/29c16836/IP-change.png" alt></p><h4 id="为什么修改？"><a class="header-anchor" href="#为什么修改？">¶</a>为什么修改？</h4><p><img src="/29c16836/IP-imge.png" alt></p><p>😄请参考：<a href="http://cn.linux.vbird.org/linux_server/0110network_basic_3.php#tcpip_network_netmask" target="_blank" rel="noopener"><strong>2.3.4 Netmask, 子网与 CIDR (Classless Interdomain Routing)</strong></a></p><h2 id="2-ssh登录小娱c5"><a class="header-anchor" href="#2-ssh登录小娱c5">¶</a>2. SSH登录小娱C5</h2><h4 id="什么是ssh"><a class="header-anchor" href="#什么是ssh">¶</a><a href="https://blog.csdn.net/u012308586/article/details/90599793" target="_blank" rel="noopener">什么是SSH?</a></h4><h4 id="确保ssh服务打开："><a class="header-anchor" href="#确保ssh服务打开：">¶</a>确保SSH服务打开：</h4><p><em>滑动到页面底部，点击</em><em>应用本页面设置</em>*</p><p><img src="/29c16836/ssh-enable.png" alt></p><h4 id="安装putty："><a class="header-anchor" href="#安装putty：">¶</a>安装PuTTY：</h4><p><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener">官方下载链接</a></p><p><a href="https://pan.baidu.com/s/1gsdQGDlTjmoJt6fQ5ZC9GA" target="_blank" rel="noopener">百度云链接</a> 提取码：<code>0qg9</code></p><p>安装之后，打开程序</p><h4 id="ssh登录："><a class="header-anchor" href="#ssh登录：">¶</a>SSH登录：</h4><p><code>Host Name</code>填入之前提到的<code>IP地址</code></p><p><code>Port(端口)</code>填写<code>22</code></p><p><code>Connection type(连接类型)</code>选择<code>SSH</code></p><p>可以在<code>Saved sessons</code>中为当前内容键入名字，点击<code>Save</code>保存在列表，下次打开程序时，直接选中已保存的项然后<code>Load</code></p><p><img src="/29c16836/putty-ssh.png" alt></p><p>点击<code>Open</code>启动SSH连接， 若一切正常，会弹出<strong>警告</strong>窗口，确认即可</p><p>若未更改初始账号，则用账号<code>admin</code> 密码<code>admin</code>登录</p><ul><li>输入账号，回车，</li><li>输入密码，密码内容不会显示，回车，</li><li>成功登录：</li></ul><p><img src="/29c16836/TIM%E6%88%AA%E5%9B%BE20190821214653.png" alt></p><h4 id="修改putty字体："><a class="header-anchor" href="#修改putty字体：">¶</a>修改PuTTY字体：</h4><p>😥默认的字体若欣赏不来，可以在 Window – Appearance – Font settings – Change… 中修改字体样式及大小</p><p><img src="/29c16836/putty-fonts.png" alt></p><p><img src="/29c16836/putty-fonts-%E9%9B%85%E9%BB%91.png" alt></p><p>😍<a href="https://github.com/yakumioto/YaHei-Consolas-Hybrid-1.12" target="_blank" rel="noopener">示例字体下载</a></p><h2 id="3-对磁盘进行分区规划-参考"><a class="header-anchor" href="#3-对磁盘进行分区规划-参考">¶</a>3. 对磁盘进行分区规划|<a href="http://koolshare.cn/thread-78681-1-38.html" target="_blank" rel="noopener">参考</a></h2><h4 id="查看磁盘"><a class="header-anchor" href="#查看磁盘">¶</a>查看磁盘</h4><p>拆开小娱C1的机壳，卸下硬盘托架，装上一块2.5寸SATA盘</p><p>SSH登录，输入命令<code>fdisk -l</code>，末尾可看见硬盘名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># fdisk -l</span></span><br><span class="line">......</span><br><span class="line">Device  Boot StartCHS    EndCHS        StartLBA     EndLBA    Sectors  Size Id Type</span><br><span class="line">/dev/sda1    0,32,33     65,101,36         2048    1050623    1048576  512M 82 Linux swap</span><br><span class="line">/dev/sda2    65,101,37   257,80,63      1050624  234441647  233391024  111G 83 Linux</span><br></pre></td></tr></table></figure><p>这里两个/dev/sda*分区是我的一个已经格式化好的128GB硬盘</p><p>以下所有操作都以/dev/sda为例，<strong>请根据自身磁盘显示的名字变通</strong></p><h4 id="fdisk命令"><a class="header-anchor" href="#fdisk命令">¶</a>fdisk命令</h4><p>fdisk是一个命令行磁盘程序，可以对MBR磁盘进行分区操作，具体使用可以借助搜索引擎</p><p>直接键入<code>fdisk</code>可查看用法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">First sector (2048-1048575, default 2048): [RT-N56U_B1 /opt/home/admin]<span class="comment"># fdisk</span></span><br><span class="line">BusyBox v1.29.3 (2019-06-08 16:33:16 CST) multi-call binary.</span><br><span class="line"></span><br><span class="line">Usage: fdisk [-ul] [-C CYLINDERS] [-H HEADS] [-S SECTORS] [-b SSZ] DISK</span><br><span class="line"></span><br><span class="line">Change partition table</span><br><span class="line"></span><br><span class="line">        -u              Start and End are <span class="keyword">in</span> sectors (instead of cylinders)</span><br><span class="line">        -l              Show partition table <span class="keyword">for</span> each DISK, <span class="keyword">then</span> <span class="built_in">exit</span></span><br><span class="line">        -b 2048         (<span class="keyword">for</span> certain MO disks) use 2048-byte sectors</span><br><span class="line">        -C CYLINDERS    Set number of cylinders/heads/sectors</span><br><span class="line">        -H HEADS        Typically 255</span><br><span class="line">        -S SECTORS      Typically 63</span><br></pre></td></tr></table></figure><h4 id="详细操作步骤"><a class="header-anchor" href="#详细操作步骤">¶</a>详细操作步骤</h4><h5 id="0-检查硬盘是否自动挂载"><a class="header-anchor" href="#0-检查硬盘是否自动挂载">¶</a>0）检查硬盘是否自动挂载</h5><p>确保/dev/sda没有被系统自动挂载</p><p>如果硬盘为NTFS，FAST32格式，可能会被自动挂载，用umount /dev/sda命令卸载掉</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># mount</span></span><br><span class="line">......</span><br><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># df -h</span></span><br><span class="line">......</span><br><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># umount /dev/sda</span></span><br></pre></td></tr></table></figure><h5 id="1-创建swap分区"><a class="header-anchor" href="#1-创建swap分区">¶</a>1）创建Swap分区</h5><ul><li><code>fdisk /dev/sda</code>，(若输入失败可按<code>Ctrl+C</code>退出fdisk)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># fdisk /dev/sda</span></span><br><span class="line">Device contains neither a valid DOS partition table, nor Sun, SGI, OSF or GPT disklabel</span><br><span class="line">Building a new DOS disklabel. Changes will remain <span class="keyword">in</span> memory only,</span><br><span class="line">until you decide to write them. After that the previous content</span><br><span class="line">won<span class="string">'t be recoverable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Command (m for help):</span></span><br></pre></td></tr></table></figure><ul><li><code>n</code> 创建一个新分区</li><li><code>p</code> 分区类型为主分区</li><li><code>1</code> 分区号为1，起始扇区为默认，直接回车或者1都可以</li><li>First sector：<code>不键入参数</code> 直接回车</li><li>Last sector：<code>+512M</code> 结束扇区，直接分配512M分区</li></ul><p>以上操作如下，每一次键入参数加上回车：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n</span><br><span class="line">Partition <span class="built_in">type</span></span><br><span class="line">   p   primary partition (1-4)</span><br><span class="line">   e   extended</span><br><span class="line">p</span><br><span class="line">Partition number (1-4): 1</span><br><span class="line">First sector (2048-1048575, default 2048): </span><br><span class="line">Using default value 2048</span><br><span class="line">Last sector or +size&#123;,K,M,G,T&#125; (2048-1048574): +512M</span><br></pre></td></tr></table></figure><h5 id="2-创建ext4分区"><a class="header-anchor" href="#2-创建ext4分区">¶</a>2）创建ext4分区</h5><p>我的硬盘是1282G，其中512M做swap分区，剩下的做/opt分区，如果你有其他规划按照自己的方式来就可以。但是要注意MBR磁盘的分区规则，最多4个主分区，单盘不超过2TB，有超过4个分区数量的需求请分一个扩展分区然后再分逻辑分区，如果是大于2TB的磁盘就不要用fdisk这个工具了</p><p>😷接着以同样的方式创建第二个分区:</p><ul><li><code>n</code> 创建一个新分区</li><li><code>p</code> 分区类型为主分区</li><li><code>2</code> 分区号为2</li><li><code>*不键入参数</code> 结束扇区默认为磁盘末尾，直接回车</li></ul><p>以上操作如下，每一次键入参数加上回车：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n</span><br><span class="line">Partition <span class="built_in">type</span></span><br><span class="line">   p   primary partition (1-4)</span><br><span class="line">   e   extended</span><br><span class="line">p</span><br><span class="line">Partition number (1-4): 2</span><br><span class="line">First sector (2048-1048575, default 2048):</span><br><span class="line">Using default value 2048</span><br><span class="line">Last sector or +size&#123;,K,M,G,T&#125; (2048-1048574, default 1048574):/*不键入参数直接回车*/</span><br><span class="line">Using default value 1048574</span><br></pre></td></tr></table></figure><h5 id="3-查看待保存的分区信息"><a class="header-anchor" href="#3-查看待保存的分区信息">¶</a>3）查看待保存的分区信息</h5><ul><li><code>p</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p</span><br><span class="line">Disk /dev/sda1: 512 MB, 536870912 bytes, 1048576 sectors</span><br><span class="line">65 cylinders, 255 heads, 63 sectors/track</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line"></span><br><span class="line">Device    Boot StartCHS    EndCHS        StartLBA     EndLBA    Sectors  Size Id Type</span><br><span class="line">/dev/sda1    65,69,4     65,69,4        1048575    1048575          1   512 83 Linux</span><br><span class="line">/dev/sda1    0,32,33     65,69,3           2048    1048574    1046527  510M 83 Linux</span><br></pre></td></tr></table></figure><p>可以看到已经创建好两个分区，不过我们要把sda1作为交换分区使用所以还是需要做以下操作</p><h5 id="4-sda1更改标签类型为swap"><a class="header-anchor" href="#4-sda1更改标签类型为swap">¶</a>4）sda1更改标签类型为swap</h5><ul><li><code>t</code> 改变主分区的id</li><li><code>1</code> 选择分区号1</li><li><code>82</code> 更改为82</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): t</span><br><span class="line">Partition number (1-4): 1</span><br><span class="line">Hex code (<span class="built_in">type</span> L to list codes): 82</span><br><span class="line">Changed system <span class="built_in">type</span> of partition 1 to 82 (Linux swap)</span><br></pre></td></tr></table></figure><h5 id="5-再次查看分区信息"><a class="header-anchor" href="#5-再次查看分区信息">¶</a>5）再次查看分区信息</h5><ul><li><code>p</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p</span><br><span class="line">Disk /dev/sda1: 512 MB, 536870912 bytes, 1048576 sectors</span><br><span class="line">65 cylinders, 255 heads, 63 sectors/track</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line"></span><br><span class="line">Device    Boot StartCHS    EndCHS        StartLBA     EndLBA    Sectors  Size Id Type</span><br><span class="line">/dev/sda1p1    65,69,4     65,69,4        1048575    1048575          1   512 82 Linux swap</span><br><span class="line">/dev/sda1p2    0,32,33     65,69,3           2048    1048574    1046527  510M 83 Linux</span><br></pre></td></tr></table></figure><h5 id="6-保存修改并退出"><a class="header-anchor" href="#6-保存修改并退出">¶</a>6）保存修改并退出</h5><ul><li><code>w</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): w</span><br></pre></td></tr></table></figure><h5 id="7-创建交换分区"><a class="header-anchor" href="#7-创建交换分区">¶</a>7）创建交换分区</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># mkswap /dev/sda1</span></span><br></pre></td></tr></table></figure><h5 id="8-开启交换分区并查看swap"><a class="header-anchor" href="#8-开启交换分区并查看swap">¶</a>8）开启交换分区并查看Swap</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># swapon /dev/sda1</span></span><br><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># free</span></span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:        450508      62940     387568          0       7388      20172</span><br><span class="line">-/+ buffers/cache:      35380     415128</span><br><span class="line">Swap:       524284          0     524284</span><br></pre></td></tr></table></figure><h5 id="9-ext4分区格式化"><a class="header-anchor" href="#9-ext4分区格式化">¶</a>9）ext4分区格式化</h5><p>老毛子中没有mkfs，只能用mke2fs创建分区</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># mke2fs -t ext4 /dev/sda2</span></span><br></pre></td></tr></table></figure><h5 id="10-重启路由-查看-dev-sda2挂载信息"><a class="header-anchor" href="#10-重启路由-查看-dev-sda2挂载信息">¶</a>10）重启路由，查看/dev/sda2挂载信息</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># mount</span></span><br></pre></td></tr></table></figure><h2 id="4-文件服务器-内部网络"><a class="header-anchor" href="#4-文件服务器-内部网络">¶</a>4. 文件服务器(内部网络)</h2><p>😳老毛子滋磁3种类别的文件服务器：</p><table><thead><tr><th>类别</th><th>平台</th></tr></thead><tbody><tr><td>ftp服务器（ftp/tftp）</td><td>任意平台</td></tr><tr><td>Samba服务器</td><td>windows，ios</td></tr><tr><td>NFS服务器</td><td>linux/unix</td></tr></tbody></table><p><strong>注意</strong>虽然samba传输文件对小娱C5内存占用较高(占180Mb左右)，但是可以在win10下看见拷贝速度，支持剪切，创建快捷方式等(ftp均不支持但消耗内存少)，为了演示，这里使用Samba</p><h4 id="开启samba服务"><a class="header-anchor" href="#开启samba服务">¶</a>开启Samba服务</h4><p><em>工作组也可以为</em><em>账号允许</em><em>但是需要登录，为了方便，这里使用</em><em>全部允许</em>*</p><p><em>滑动到页面底部，点击</em><em>应用本页面设置</em>*</p><p><img src="/29c16836/SMB.png" alt></p><p>开启win10系统的SMB功能：</p><p><img src="/29c16836/win-smb1.png" alt="win-smb1"></p><p><img src="/29c16836/win-smb2.png" alt="win-smb2"></p><p>点击确定，等待重启</p><p>在windows资源管理器 – 网络 中会自动出现RT-N56_B1，点击即可看见AiDisk_a2(对应/dev/sda2)，再次点击即可看见sata盘内的文件，可以右键AiDisk_a2创建快捷方式在桌面然后固定到开始屏幕，或者固定到快速访问也行</p><p><img src="/29c16836/SMB=win.png" alt></p><h2 id="5-aria2下载工具"><a class="header-anchor" href="#5-aria2下载工具">¶</a>5.Aria2下载工具</h2><p>老毛子自带的Aria2是个轻量级下载程序，自带Web UI界面，占用内存小，支持的下载协议有http、https、bt、磁力链接，能运行于基本上所有常用平台，例如安卓、Windows、Linux等等，相比迅雷和百度云这类常用工具，占用资源少没有限速，是一款免费软件</p><h4 id="启用aria2"><a class="header-anchor" href="#启用aria2">¶</a>启用Aria2</h4><p>USB应用程序 – 其他设置</p><p><em>滑动到页面底部，点击</em><em>应用本页面设置</em>*</p><p><img src="/29c16836/Aria2.png" alt></p><h4 id="进入web-ui界面"><a class="header-anchor" href="#进入web-ui界面">¶</a>进入Web UI界面</h4><p>浏览器访问 <a href="http://192.168.124.1/ariaweb/index.html" target="_blank" rel="noopener">http://192.168.124.1/ariaweb/index.html</a></p><p><img src="/29c16836/Aria2-web.png" alt></p><h4 id="使用教程"><a class="header-anchor" href="#使用教程">¶</a><a href="https://www.jianshu.com/p/011504d11607" target="_blank" rel="noopener">使用教程</a></h4><h2 id="6-百度云"><a class="header-anchor" href="#6-百度云">¶</a>6. 百度云</h2><p>BaiduPCS-Go是纯命令行的程序，操作不太方便，推荐使用BaiduPCS-Web</p><p>BaiduPCS-Web基于BaiduPCS-Go开发，加入了Web UI界面，自带跨平台属性，支持Windows，Mac，Linux</p><p>官方介绍的操作步骤很详尽，在此不做太多复述</p><p><a href="https://github.com/liuzhuoling2011/baidupcs-web" target="_blank" rel="noopener">项目地址</a></p><p><a href="https://w.url.cn/s/AdjX09Y" target="_blank" rel="noopener">使用介绍</a></p><h4 id="使用注意"><a class="header-anchor" href="#使用注意">¶</a>使用注意</h4><p><img src="/29c16836/baiduPCS.png" alt></p><p>打开浏览器, 输入 <a href="http://localhost:5299" target="_blank" rel="noopener">http://localhost:5299</a> 查看效果的localhost是你路由器的IP地址，例如·我这里是http://192.168.124.1:5299</p><p>第一次下载可能成功，但百度云最近越来越严了</p><p>因为此软件不限速，所以很可能检测到你下载的速度不正常，</p><p>比如出现：</p><p><strong>user is not authorized, hitcode:123</strong></p><p><a href="https://github.com/liuzhuoling2011/baidupcs-web/issues/59" target="_blank" rel="noopener">问题详见 </a></p><p>😥建议开通钞级会员解决</p><p><img src="/29c16836/baiduPCS-error.png" alt></p><h2 id="6-酸酸乳"><a class="header-anchor" href="#6-酸酸乳">¶</a>6. 酸酸乳</h2><p>参考：<a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=192381" target="_blank" rel="noopener">H大老毛子固件搭建酸酸乳服务器及免流方法</a><br>1.固件中搭建SSR，需要安装OPT环境，请先完成本文的 <strong>7. 使用opkg在sata盘中安装程序</strong><br>2.OPT环境安装成功后，进入如下界面，如何配置一目了然</p><p>*酸酸乳配置页面，<strong>有两个应用本页面设置</strong>，一个是开关，另一个是节点配置的应用设置<img src="/29c16836/%E9%85%B8%E9%85%B8%E4%B9%B3.png" alt></p><h2 id="7-使用opkg在sata盘中安装程序"><a class="header-anchor" href="#7-使用opkg在sata盘中安装程序">¶</a>7. 使用opkg在sata盘中安装程序</h2><h4 id="打开opkg"><a class="header-anchor" href="#打开opkg">¶</a>打开opkg</h4><p>opt安装模式设置如下图</p><p><img src="/29c16836/opt-update.png" alt></p><p><em>滑动到页面底部，点击</em><em>应用本页面设置</em>*</p><p>重启设备，等待自动安装</p><h4 id="opkg初始化"><a class="header-anchor" href="#opkg初始化">¶</a>opkg初始化</h4><p><a href="https://openwrt.org/zh/docs/techref/opkg" target="_blank" rel="noopener">opkg是什么？</a></p><p>SSH登录后，执行<code>df -h</code>查看挂载的/dev/sda2的文件路径</p><p>若/opt目录也在/dev/sda2中前一步则opt路径设置成功，如下图：<img src="/29c16836/df-h.png" alt></p><p>若在硬盘上创建/opt路径失败，<a href="https://zhih.me/Padavan-entware/" target="_blank" rel="noopener">请参考</a></p><p>进入路径/opt，初始化并更新opkg</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 /opt/home/admin]<span class="comment"># cd /opt</span></span><br><span class="line"></span><br><span class="line">/*初始化opkg*/</span><br><span class="line">[RT-N56U_B1 /opt]<span class="comment"># opkg.sh</span></span><br><span class="line">......</span><br><span class="line">/*更新opkg源，可能需要fq*/</span><br><span class="line">[RT-N56U_B1 /opt]<span class="comment"># opkg update</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure><h4 id="opkg测试"><a class="header-anchor" href="#opkg测试">¶</a>opkg测试</h4><p><strong>查看opkg源的软件包列表</strong></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[RT-N56U_B1 <span class="meta-keyword">/media/</span>AiDisk_a2]<span class="meta"># opkg list <span class="comment">/*请等待软件源列表嗖嗖上蹿*/</span></span></span><br><span class="line">......</span><br></pre></td></tr></table></figure><h4 id="opkg安装nmon-可选"><a class="header-anchor" href="#opkg安装nmon-可选">¶</a>opkg安装nmon|可选</h4><p>Nmon** 是一个可以监控当前系统性能的小工具，可以查看网络、CPU、内存和磁盘的使用情况</p><p>使用之前先用命令<code>opkg install nmon</code>进行安装</p><p>安装好后执行 <code>nmon</code> 命令即可打开：</p><p><img src="/29c16836/nmon-install.png" alt></p><p>打开之后，按 c 查看 CPU 信息，按 n 查看网络信息：</p><p><img src="/29c16836/nmon.png" alt></p><p>按<code>Ctrl+Z</code>退出</p><p>opkg还可以下载gcc，python3.7，go，vim-full等</p><h2 id="小娱c5-刷机篇"><a class="header-anchor" href="#小娱c5-刷机篇">¶</a><a href="https://oldgerman.github.io/0/" target="_blank" rel="noopener">小娱C5_刷机篇</a></h2>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小娱C5_刷机篇</title>
      <link href="/0/"/>
      <url>/0/</url>
      
        <content type="html"><![CDATA[<h2 id="1-配置概览"><a class="header-anchor" href="#1-配置概览">¶</a>1. 配置概览</h2><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">SOC</th><th style="text-align:center">2.4G</th><th style="text-align:center">5G</th><th style="text-align:center">RAM</th><th style="text-align:center">ROM</th><th style="text-align:center">USB</th><th>SATA</th><th style="text-align:center">LAN</th><th style="text-align:center">WAN</th><th style="text-align:center">￥</th></tr></thead><tbody><tr><td style="text-align:center"><strong>小娱C1/C5</strong></td><td style="text-align:center">MT7621A 880MHz</td><td style="text-align:center">N/A</td><td style="text-align:center">N/A</td><td style="text-align:center">512MB DDR3</td><td style="text-align:center">32M Flash</td><td style="text-align:center">1*3.0</td><td>1*2.0</td><td style="text-align:center">4*1Gbps</td><td style="text-align:center">1*1Gbps</td><td style="text-align:center">50~60</td></tr><tr><td style="text-align:center"><strong>Newifi 3</strong></td><td style="text-align:center">MT7621A 880MHz</td><td style="text-align:center">2*2 300Mbps</td><td style="text-align:center">2*2 867Mbps</td><td style="text-align:center">512MB DDR3</td><td style="text-align:center">2*32M Flash</td><td style="text-align:center">1*3.0</td><td>N/A</td><td style="text-align:center">4*1Gbps</td><td style="text-align:center">1*1Gbps</td><td style="text-align:center">119~150</td></tr><tr><td style="text-align:center"><strong>斐讯K2P</strong></td><td style="text-align:center">MT7621A 880MHz</td><td style="text-align:center">2*2 400Mbps</td><td style="text-align:center">2*2 867Mbps</td><td style="text-align:center">128MB DDR3</td><td style="text-align:center">16M Flash</td><td style="text-align:center">N/A</td><td>N/A</td><td style="text-align:center">4*1Gbps</td><td style="text-align:center">1*1Gbps</td><td style="text-align:center">210~250</td></tr><tr><td style="text-align:center"><strong>小米Pro</strong></td><td style="text-align:center">MT7621A 880MHz</td><td style="text-align:center">4*4 800Mbps</td><td style="text-align:center">4*4 1733Mbps</td><td style="text-align:center">512MB DDR3</td><td style="text-align:center">256M Nand</td><td style="text-align:center">1*3.0</td><td>N/A</td><td style="text-align:center">3*1Gbps</td><td style="text-align:center">1*1Gbps</td><td style="text-align:center">499</td></tr></tbody></table><h2 id="2-资源包"><a class="header-anchor" href="#2-资源包">¶</a>2. 资源包</h2><p>百度云链接：<a href="https://pan.baidu.com/s/1-KpmX9guIDLhQYw00e4vwQ" target="_blank" rel="noopener">XiaoYu_C5_Breed.zip + H大老毛子 + 其他可用固件</a> 提取码：<code>5hjd</code></p><h2 id="3-原厂web控制台"><a class="header-anchor" href="#3-原厂web控制台">¶</a>3. 原厂Web控制台</h2><p>打开浏览器，输入机器外壳背面的 IP地址：<code>192.168.188.1</code> 密码：<code>admin</code></p><p><img src="/0/IMG_5324.jpg" alt></p><h4 id="原厂控制台界面："><a class="header-anchor" href="#原厂控制台界面：">¶</a>原厂控制台界面：</h4><p><img src="/0/Inked%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(147)_LI.jpg" alt></p><p>看一看，SATA硬盘可以识别，但貌似ssh打不开，所以没啥卵用：</p><p><img src="/0/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(148).png" alt></p><h2 id="4-刷入breed"><a class="header-anchor" href="#4-刷入breed">¶</a>4. 刷入Breed</h2><h4 id="beed是啥？"><a class="header-anchor" href="#beed是啥？">¶</a>Beed是啥？</h4><p>breed由恩山论坛大神<a href="https://www.right.com.cn/forum/space-uid-200302.html" target="_blank" rel="noopener">HackPascal</a>开发，breed是一种Bootloader，类似于电脑的BIOS，核心功能是引导操作系统，常见的uboot启动是单线程的，而breed是多线程的，难度系数比uboot大得多，增加了调度器，已经具备小型操作系统的核心</p><h4 id="莫大佬文章的源地址："><a class="header-anchor" href="#莫大佬文章的源地址：">¶</a>莫大佬文章的源地址：</h4><p>一键刷入BREED教程：<a href="http://www.nas1688.com/166.html" target="_blank" rel="noopener">已失效</a></p><h4 id="在此重新复述刷入方法："><a class="header-anchor" href="#在此重新复述刷入方法：">¶</a>在此重新复述刷入方法：</h4><ul><li>上电启动，使用网线连接电脑和小娱路由器C5的任意Lan口</li><li>解压上面的度云文件：<code>XiaoYu_C5_Breed.zip</code> 解压密码：<code>www.nas1688.com</code></li><li>win10下直接该程序运行不行，需要右键 <strong>以管理员模式运行该程序</strong>，才能刷入成功不死breed<br>等待电脑分配到小娱的IP，可以访问<code>192.168.188.1</code>就行</li><li>将网关IP填入工具中，默认密码admin，点击刷入即可</li></ul><h4 id="刷入成功："><a class="header-anchor" href="#刷入成功：">¶</a>刷入成功：</h4><p><img src="/0/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(149).png" alt></p><p>根据提示，先拔掉电源，等待下一步操作</p><h2 id="5-重启到breed-web控制台"><a class="header-anchor" href="#5-重启到breed-web控制台">¶</a>5. 重启到Breed Web控制台</h2><h4 id="注意事项："><a class="header-anchor" href="#注意事项：">¶</a>注意事项：</h4><ul><li>刷第三方固件一定要进入Breed界面刷入</li><li>Breed界面进入方法:<br>a. 拔掉电源<br>b. 按住Reset键不放<br>c. 接通电源<br>d. 6秒后松开Reset键<br>e. 浏览器访问：<code>192.168.1.1</code>进入 Breed Web控制台</li></ul><p><img src="/0/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(150).png" alt></p><h2 id="6-备份固件-可选"><a class="header-anchor" href="#6-备份固件-可选">¶</a>6. 备份固件|可选</h2><p>将EEPROM，编程器固件备份，保存生成的文件，若以后想刷回原厂固件，在Breed Web恢复即可</p><p><img src="/0/Inked%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(151)_LI.jpg" alt></p><h2 id="7-刷入h大老毛子"><a class="header-anchor" href="#7-刷入h大老毛子">¶</a>7. 刷入H大老毛子</h2><h4 id="解压固件："><a class="header-anchor" href="#解压固件：">¶</a>解压固件：</h4><p>解压上面的度云文件：<code>小娱同学可用固件.rar</code></p><p>再次解压前一次解压得到的：<code>MT7621_7603_7612_512M_3.4.3.9-099.rar</code></p><p>得到：<code>MT7621_7603_7612_512M_3.4.3.9-099.trx</code></p><p><img src="/0/TIM%E6%88%AA%E5%9B%BE20190821154510.png" alt></p><h4 id="上传固件："><a class="header-anchor" href="#上传固件：">¶</a>上传固件：</h4><p>在Breed Web控制台 - - 固件更新</p><ul><li>勾选固件</li><li>选择文件<code>MT7621_7603_7612_512M_3.4.3.9-099.trx</code>上传</li></ul><p><img src="/0/TIM%E6%88%AA%E5%9B%BE20190821154047.png" alt></p><h4 id="等待刷入成功："><a class="header-anchor" href="#等待刷入成功：">¶</a>等待刷入成功：</h4><p><img src="/0/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(152).png" alt></p><p>刷入时观察路由面板指示灯，若全部熄灭了再亮时说明开始重启，这之后等待一两分钟载入老毛子系统</p><h2 id="8-重启到-h大老毛子-web控制台"><a class="header-anchor" href="#8-重启到-h大老毛子-web控制台">¶</a>8. 重启到 H大老毛子 Web控制台</h2><p>上一步重启完成后，浏览器访问：<code>192.168.123.1</code></p><p>初始账号：<code>admin</code></p><p>初始密码：<code>admin</code></p><p>因为小娱C5不带无线，建议关闭2.4G，5G 以节约性能：</p><p><img src="/0/TIM%E6%88%AA%E5%9B%BE20190821160818.png" alt></p><p>至此，刷入完毕</p><h3 id="小娱c5-配置篇"><a class="header-anchor" href="#小娱c5-配置篇">¶</a><a href="https://oldgerman.github.io/29c16836/" target="_blank" rel="noopener">小娱C5_配置篇</a></h3>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>hexo如何上传本地图片</title>
      <link href="/eeea93b8/"/>
      <url>/eeea93b8/</url>
      
        <content type="html"><![CDATA[<h3 id="1-修改站点配置文件"><a class="header-anchor" href="#1-修改站点配置文件">¶</a>1. 修改站点配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/* 路径 /hexo/_config.yml</span><br><span class="line">post_asset_folder: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>这之后，当你 hexo n XXX 时，会自动在 /hexo/source/_post 下生成一个 XXX 文件夹；</p><p>我们将需要插入 XXX 博文的图片 Test.jpg 放到此文件夹，稍后用Typora编辑博文时直接拖入即可</p><h3 id="2-安装路径转换插件-踩坑"><a class="header-anchor" href="#2-安装路径转换插件-踩坑">¶</a>2. 安装路径转换插件|踩坑</h3><h4 id="注意-一定要下："><a class="header-anchor" href="#注意-一定要下：">¶</a>注意，一定要下：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install https://github.com/CodeFalling/hexo-asset-image --save</span><br><span class="line">......</span><br><span class="line">+ hexo-asset-image@0.0.5</span><br></pre></td></tr></table></figure><p>正确生成为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">INFO  Start processing</span><br><span class="line">update link as:--&gt;/2019/08/20/<span class="built_in">test</span>/Test.jpg</span><br><span class="line">update link as:--&gt;/2019/08/20/<span class="built_in">test</span>/Test.jpg</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>如有生成绝对路径不完整，<a href="https://github.com/xcodebuild/hexo-asset-image/issues/13" target="_blank" rel="noopener">请参考</a></p><h4 id="注意-不要下："><a class="header-anchor" href="#注意-不要下：">¶</a>注意，不要下：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br><span class="line">......</span><br><span class="line">+ hexo-asset-image@1.0.0</span><br></pre></td></tr></table></figure><p>hexo-asset-image@1.0.0版本根本无法在 hexo g 生成的 *.html 文件中生成正确的 img src 的路径</p><p>错误生成如下，无法载入图片：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">INFO  Start processing</span><br><span class="line">update link as:--&gt;/.com//Test.jpg</span><br><span class="line">update link as:--&gt;/.com//Test.jpg</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h3 id="3-安装typora"><a class="header-anchor" href="#3-安装typora">¶</a>3. 安装Typora</h3><p>将Typora设置为*.md文件的默认编辑器</p><p>进入 /hexo/source/_post</p><p>打开刚才创建的 <a href="http://XXX.md" target="_blank" rel="noopener">XXX.md</a> 文件</p><p>将 /hexo/source/_post/XXX/Test.jpg 直接拖拽到 Typora 编辑界面</p><p>会自动连带图片生成：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Test</span>](<span class="link">D:\ODG blog\oldgerman.github.io\source\_posts\hexo如何上传本地图片\Test.jpg</span>)</span><br></pre></td></tr></table></figure><p>将就绝对路径删除部分，仅保留：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Test-Image</span>](<span class="link">\hexo如何上传本地图片\Test.jpg</span>)</span><br></pre></td></tr></table></figure><p>并将两个 \ 修改成：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Test-Image</span>](<span class="link">/hexo如何上传本地图片/Test.jpg</span>)</span><br></pre></td></tr></table></figure><p>若挪开选中图片的鼠标，自动隐藏引用代码，仅将图片显示：</p><p><img src="/eeea93b8/Test.jpg" alt="Test-Image"></p><h3 id="4-本地测试-上传到github"><a class="header-anchor" href="#4-本地测试-上传到github">¶</a>4. 本地测试+上传到GitHub</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure><p>至此，测试完毕！</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小米平板1-ubuntu系统_bluetooth篇</title>
      <link href="/192f845b/"/>
      <url>/192f845b/</url>
      
        <content type="html"><![CDATA[<h2 id="csr8510蓝牙适配器：驱动模块编译-开机自动加载"><a class="header-anchor" href="#csr8510蓝牙适配器：驱动模块编译-开机自动加载">¶</a>CSR8510蓝牙适配器：驱动模块编译/开机自动加载</h2><h3 id="配置好-config文件后："><a class="header-anchor" href="#配置好-config文件后：">¶</a>配置好./config文件后：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line">root@tegra-ubuntu:/usr/src/kernel<span class="comment"># make modules</span></span><br><span class="line">  LD [M]  crypto/md4.ko</span><br><span class="line">  LD [M]  crypto/sha256_generic.ko</span><br><span class="line">  LD [M]  crypto/tcrypt.ko</span><br><span class="line">  LD [M]  crypto/twofish_common.ko</span><br><span class="line">  LD [M]  crypto/twofish_generic.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/bcm203x.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/bfusb.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/bpa10x.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/broadcom/bt_protocol_driver/brcm_bt_drv.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/broadcom/v4l2_fm_driver/fm_drv.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/broadcom/line_discipline_driver/brcm_hci_ldisc.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/btusb.ko</span><br><span class="line">  LD [M]  drivers/bluetooth/hci_uart.ko</span><br><span class="line">  LD [M]  drivers/input/joystick/xpad.ko</span><br><span class="line">  LD [M]  drivers/input/joydev.ko</span><br><span class="line">  LD [M]  drivers/media/platform/soc_camera/soc_camera_platform.ko</span><br><span class="line">  LD [M]  drivers/media/usb/gspca/gspca_main.ko</span><br><span class="line">  LD [M]  drivers/media/platform/soc_camera/tegra_camera/tegra_camera.ko</span><br><span class="line">  LD [M]  drivers/media/v4l2-core/videobuf2-dma-contig.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/bsd_comp.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/ppp_async.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/ppp_deflate.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/ppp_generic.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/ppp_mppe.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/ppp_synctty.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/pppolac.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/pppopns.ko</span><br><span class="line">  LD [M]  drivers/net/ppp/pppox.ko</span><br><span class="line">  LD [M]  drivers/net/usb/raw_ip_net.ko</span><br><span class="line">  LD [M]  drivers/net/slip/slhc.ko</span><br><span class="line">  LD [M]  drivers/usb/class/cdc-acm.ko</span><br><span class="line">  LD [M]  drivers/usb/class/cdc-wdm.ko</span><br><span class="line">  LD [M]  drivers/usb/gadget/g_ether.ko</span><br><span class="line">  LD [M]  drivers/usb/gadget/g_mass_storage.ko</span><br><span class="line">  LD [M]  drivers/usb/gadget/libcomposite.ko</span><br><span class="line">  LD [M]  drivers/usb/serial/baseband_usb_chr.ko</span><br><span class="line">  LD [M]  drivers/video/tegra/host/vi/nvhost-vi.ko</span><br><span class="line">  LD [M]  fs/cifs/cifs.ko</span><br><span class="line">  LD [M]  net/bluetooth/bluetooth.ko</span><br><span class="line">  LD [M]  fs/configfs/configfs.ko</span><br><span class="line">  LD [M]  net/bluetooth/bnep/bnep.ko</span><br><span class="line">  LD [M]  net/bluetooth/hidp/hidp.ko</span><br><span class="line">  LD [M]  net/bluetooth/rfcomm/rfcomm.ko</span><br><span class="line">  LD [M]  net/rfkill/rfkill-gpio.ko</span><br><span class="line">root@tegra-ubuntu:/usr/src/kernel<span class="comment"># </span></span><br><span class="line"></span><br><span class="line">root@tegra-ubuntu:/usr/src/kernel<span class="comment"># make modules_install</span></span><br><span class="line">  INSTALL crypto/md4.ko</span><br><span class="line">  INSTALL crypto/sha256_generic.ko</span><br><span class="line">  INSTALL crypto/tcrypt.ko</span><br><span class="line">  INSTALL crypto/twofish_common.ko</span><br><span class="line">  INSTALL crypto/twofish_generic.ko</span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/bcm203x.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/bfusb.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/bpa10x.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/broadcom/bt_protocol_driver/brcm_bt_drv.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/broadcom/line_discipline_driver/brcm_hci_ldisc.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/broadcom/v4l2_fm_driver/fm_drv.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/btusb.ko</span></span><br><span class="line"><span class="comment">#  INSTALL drivers/bluetooth/hci_uart.ko</span></span><br><span class="line">  INSTALL drivers/input/joydev.ko</span><br><span class="line">  INSTALL drivers/input/joystick/xpad.ko</span><br><span class="line">  INSTALL drivers/media/platform/soc_camera/soc_camera_platform.ko</span><br><span class="line">  INSTALL drivers/media/platform/soc_camera/tegra_camera/tegra_camera.ko</span><br><span class="line">  INSTALL drivers/media/usb/gspca/gspca_main.ko</span><br><span class="line">  INSTALL drivers/media/v4l2-core/videobuf2-dma-contig.ko</span><br><span class="line">  INSTALL drivers/net/ppp/bsd_comp.ko</span><br><span class="line">  INSTALL drivers/net/ppp/ppp_async.ko</span><br><span class="line">  INSTALL drivers/net/ppp/ppp_deflate.ko</span><br><span class="line">  INSTALL drivers/net/ppp/ppp_generic.ko</span><br><span class="line">  INSTALL drivers/net/ppp/ppp_mppe.ko</span><br><span class="line">  INSTALL drivers/net/ppp/ppp_synctty.ko</span><br><span class="line">  INSTALL drivers/net/ppp/pppolac.ko</span><br><span class="line">  INSTALL drivers/net/ppp/pppopns.ko</span><br><span class="line">  INSTALL drivers/net/ppp/pppox.ko</span><br><span class="line">  INSTALL drivers/net/slip/slhc.ko</span><br><span class="line">  INSTALL drivers/net/usb/raw_ip_net.ko</span><br><span class="line">  INSTALL drivers/usb/class/cdc-acm.ko</span><br><span class="line">  INSTALL drivers/usb/class/cdc-wdm.ko</span><br><span class="line">  INSTALL drivers/usb/gadget/g_ether.ko</span><br><span class="line">  INSTALL drivers/usb/gadget/g_mass_storage.ko</span><br><span class="line">  INSTALL drivers/usb/gadget/libcomposite.ko</span><br><span class="line">  INSTALL drivers/usb/serial/baseband_usb_chr.ko</span><br><span class="line">  INSTALL drivers/video/tegra/host/vi/nvhost-vi.ko</span><br><span class="line">  INSTALL fs/cifs/cifs.ko</span><br><span class="line">  INSTALL fs/configfs/configfs.ko</span><br><span class="line"><span class="comment">#  INSTALL net/bluetooth/bluetooth.ko</span></span><br><span class="line"><span class="comment">#  INSTALL net/bluetooth/bnep/bnep.ko</span></span><br><span class="line"><span class="comment">#  INSTALL net/bluetooth/hidp/hidp.ko</span></span><br><span class="line"><span class="comment">#  INSTALL net/bluetooth/rfcomm/rfcomm.ko</span></span><br><span class="line"><span class="comment">#?  INSTALL net/rfkill/rfkill-gpio.ko</span></span><br><span class="line">  DEPMOD  3.10.40-gc5d0751</span><br><span class="line"><span class="comment">#         ^^^^^^^^^^^^^^^^</span></span><br><span class="line">--------------------------------------------</span><br><span class="line"><span class="comment"># rc.local脚本:</span></span><br><span class="line"><span class="comment"># 加载顺序自下而上：</span></span><br><span class="line">insmod <span class="string">'/usr/src/kernel/net/bluetooth/bluetooth.ko'</span></span><br><span class="line">insmod <span class="string">'/usr/src/kernel/net/rfkill/rfkill-gpio.ko'</span></span><br><span class="line">insmod <span class="string">'/usr/src/kernel/net/bluetooth/rfcomm/rfcomm.ko'</span></span><br><span class="line">insmod <span class="string">'/lib/modules/3.10.40-gc5d0751/kernel/drivers/bluetooth/btusb.ko'</span> </span><br><span class="line">insmod <span class="string">'/usr/src/kernel/drivers/bluetooth/hci_uart.ko'</span> </span><br><span class="line">insmod <span class="string">'/usr/src/kernel/drivers/bluetooth/bcm203x.ko'</span></span><br><span class="line">insmod <span class="string">'/usr/src/kernel/drivers/bluetooth/bfusb.ko'</span></span><br><span class="line">insmod <span class="string">'/usr/src/kernel/drivers/bluetooth/bpa10x.ko'</span></span><br><span class="line">insmod <span class="string">'/usr/src/kernel/net/bluetooth/bnep/bnep.ko'</span> </span><br><span class="line">insmod <span class="string">'/usr/src/kernel/net/bluetooth/hidp/hidp.ko'</span></span><br><span class="line">————————————————————————————————————————————————————</span><br><span class="line">[只要这几个就够了,不安装smoke3.10.107内核里的BCM蓝牙驱动</span><br><span class="line">root@tegra-ubuntu:/home/ubuntu<span class="comment"># lsmod</span></span><br><span class="line">Module                  Size  Used by</span><br><span class="line">hidp                   14086  0 </span><br><span class="line">bnep                   11864  0 </span><br><span class="line">bpa10x                  4858  0 </span><br><span class="line">bfusb                   8138  0 </span><br><span class="line">bcm203x                 3277  0 </span><br><span class="line">hci_uart               26740  0 </span><br><span class="line">btusb                  16048  0 </span><br><span class="line">rfcomm                 46451  0 </span><br><span class="line">rfkill_gpio             2300  0 </span><br><span class="line">bluetooth             279879  11 bnep,hidp,bfusb,btusb,bpa10x,hci_uart,rfcomm,brcm_hci_ldisc,bcm203x</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line">[BCM4356]</span><br><span class="line">http://b8807053.pixnet.net/blog/post/347831957-bluez%E7%9B%B8%E9%97%9C%E7%9A%84%E5%90%84%E7%A8%AEtools%E7%9A%84%E4%BD%BF%E7%94%A8</span><br><span class="line">Bluez相關的各種tools的使用</span><br><span class="line"></span><br><span class="line">1. 安裝套件</span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment">#sudo apt-get install bluetooth bluez bluez-hcidump</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">其中 bluetooth 套件包含了底層的 hci (host controller interface) 和 sdp (service discovery protocol) 工具。而 bluez 則是官方藍牙軟體協定 (Official Linux Bluetooth protocol stack)，屬於較上層。bluez 的網頁如下: http://www.bluez.org/</span><br><span class="line"></span><br><span class="line">------------------------------------------------------</span><br><span class="line">root@tegra-ubuntu:/home/ubuntu<span class="comment"># proxychains apt-get install bluetooth bluez bluez-hcidump</span></span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">bluez is already the newest version.</span><br><span class="line">bluez <span class="built_in">set</span> to manually installed.</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  bluetooth bluez-gstreamer bluez-hcidump</span><br><span class="line">...</span><br><span class="line">Selecting previously unselected package bluetooth.</span><br><span class="line">(Reading database ... 134589 files and directories currently installed.)</span><br><span class="line">Preparing to unpack .../bluetooth_4.101-0ubuntu13_all.deb ...</span><br><span class="line">Unpacking bluetooth (4.101-0ubuntu13) ...</span><br><span class="line">Selecting previously unselected package bluez-gstreamer.</span><br><span class="line">Preparing to unpack .../bluez-gstreamer_4.101-0ubuntu13_armhf.deb ...</span><br><span class="line">Unpacking bluez-gstreamer (4.101-0ubuntu13) ...</span><br><span class="line">Selecting previously unselected package bluez-hcidump.</span><br><span class="line">Preparing to unpack .../bluez-hcidump_2.5-1_armhf.deb ...</span><br><span class="line">Unpacking bluez-hcidump (2.5-1) ...</span><br><span class="line">Processing triggers <span class="keyword">for</span> man-db (2.6.7.1-1ubuntu1) ...</span><br><span class="line">Setting up bluetooth (4.101-0ubuntu13) ...</span><br><span class="line">Setting up bluez-gstreamer (4.101-0ubuntu13) ...</span><br><span class="line">Setting up bluez-hcidump (2.5-1) ...</span><br><span class="line">root@tegra-ubuntu:/home/ubuntu<span class="comment">#</span></span><br><span class="line">---------------------------------------------------</span><br><span class="line"><span class="comment">#不要安装</span></span><br><span class="line">root@tegra-ubuntu:/home/ubuntu<span class="comment">#  apt-get install bluez-utils [无效!!!],会使hciconfig无效,重启回复正常</span></span><br><span class="line">**************************************************************</span><br><span class="line">开机插上CSR8510模块等一会gnome 蓝牙设置窗口自动识别</span><br><span class="line">配对B.O.W需要按住Fn+Delete初始化了再配对</span><br><span class="line"></span><br><span class="line">------------------测试------------------------------------</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">root@tegra-ubuntu:/etc<span class="comment"># dmesg | grep -i blue</span></span><br><span class="line">[   23.330606] init: bluetooth main process (1080) terminated with status 1</span><br><span class="line">[   23.330650] init: bluetooth main process ended, respawning</span><br><span class="line">[   24.463328] Bluetooth: Core ver 2.16</span><br><span class="line">[   24.463410] Bluetooth: HCI device and connection manager initialized</span><br><span class="line">[   24.463447] Bluetooth: HCI socket layer initialized</span><br><span class="line">[   24.463466] Bluetooth: L2CAP socket layer initialized</span><br><span class="line">[   24.463498] Bluetooth: SCO socket layer initialized</span><br><span class="line">[   24.490456] Bluetooth: RFCOMM TTY layer initialized</span><br><span class="line">[   24.490497] Bluetooth: RFCOMM socket layer initialized</span><br><span class="line">[   24.490506] Bluetooth: RFCOMM ver 1.11</span><br><span class="line">[   24.529249] Bluetooth: HCI UART driver ver 2.2</span><br><span class="line">[   24.529261] Bluetooth: HCI H4 protocol initialized</span><br><span class="line">[   24.529268] Bluetooth: HCI BCSP protocol initialized</span><br><span class="line">[   24.529275] Bluetooth: HCILL protocol initialized</span><br><span class="line">[   24.529281] Bluetooth: HCIATH3K protocol initialized</span><br><span class="line">[   24.529287] Bluetooth: HCI Three-wire UART (H5) protocol initialized</span><br><span class="line">[   24.566516] Bluetooth: BNEP (Ethernet Emulation) ver 1.3</span><br><span class="line">[   24.566533] Bluetooth: BNEP filters: protocol multicast</span><br><span class="line">[   24.566570] Bluetooth: BNEP socket layer initialized</span><br><span class="line">[   24.578784] Bluetooth: HIDP (Human Interface Emulation) ver 1.2</span><br><span class="line">[   24.578827] Bluetooth: HIDP socket layer initialized</span><br><span class="line">[   56.791738] input: B.O.W as /devices/platform/tegra-ehci.0/usb2/2-1/2-1:1.0/bluetooth/hci0/hci0:70/input2</span><br><span class="line">[   56.792059] hid-generic 0005:05AC:023C.0001: input: BLUETOOTH HID v0.01 Keyboard [B.O.W] on 00:1a:7d:da:71:11</span><br><span class="line">-------------------------------------------------------------</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>小米平板1-ubuntu系统_刷机篇</title>
      <link href="/561a0aca/"/>
      <url>/561a0aca/</url>
      
        <content type="html"><![CDATA[<p>半年前博主在学习C语言语法，无奈时间较零散，砖头书不能随身带，就用se看电子书，渐渐想随时敲敲代码跑跑程序（光看书实在是太无聊了），与此同时，也在鼓捣linux（其实那时手头连一个运行linux的电脑都没），于是就开始选设备，从树梅派挑到nexus7再到chromebook，额。。。买东西真累，想起手头有块闲置的一代小米平板，先是用termux凑合，再是安装Kali，用ssh登录本地端口，在安卓环境并行运行linux，emmm，没有GUI的linux真难受。。。最后求助万能的google，找到4PDA论坛mocha大神从英伟达tegra-k1开发板上移植的ubuntu14.04<a href="https://4pda.ru/forum/index.php?showtopic=821143" target="_blank" rel="noopener">项目地址</a>，成功刷入小米平板！</p><p><img src="/561a0aca/1.jpg" alt="刷入成功效果"></p><h2 id="准备工作"><a class="header-anchor" href="#准备工作">¶</a>准备工作</h2><h3 id="解bl琐"><a class="header-anchor" href="#解bl琐">¶</a>解BL琐</h3><p>想要刷入第三方ROM，先要刷入第三方rec；<br>想要刷入第三方rec，先要解Bootloader琐。<br>按照官方操作即可：<a href="http://www.miui.com/unlock/index.html" target="_blank" rel="noopener">解锁小米手机</a></p><h3 id="刷twrp和multirom"><a class="header-anchor" href="#刷twrp和multirom">¶</a>刷TWRP和multirom</h3><p><a href="https://pan.baidu.com/s/18b-AI4UijXQeEea_Zrd09g" target="_blank" rel="noopener">recovery工具链接</a>提取码: qc15<br>解BL琐后，将上述链接下载的所有文件(不用解压）放在平板根目录，开机按“音量+”和电源键，进入MIUI原厂recovery,刷入miuies_TWRP_MiPad_2.7.1_signed.zip<br>待刷入完成，重启到recovery，进入TWRP-v2.7.1界面，该recovery画面不能填充整个屏幕，稍后咱刷入multirom_TWRP_3.1.1-0.img即可解决。<br>*注意: v3.0.3必须由v2.7.1升级，不能一次刷入</p><p>在TWRP-v2.7.1界面，点击&quot;Install&quot;，进入文件目录，找到sd_card文件夹，点击进入，此文件夹即是平板内部flash储存的根目录。找到boot-kexec-miuiSmoke6.12.22.zip，点击此文件，右滑刷入，待刷入完成。再找一找multirom_TWRP_3.1.1-0.img发现并没有，点击右下脚的zip方框，选择img，再找下，即可找到，点击此文件，右滑刷入，待刷入完成，点击“reboot to system”，重启到系统</p><p>若一切正常，开机会出现multirom多重引导，点击倒计时即可手动选择启动系统，点击第一个系统，即可正常进入当前系统。<br><img src="/561a0aca/2.jpg" alt="刷入lineageOS和ubuntu后的multirom开机引导界面"></p><p>若仅想用MultiRom功能，仅到此步即可。</p><h3 id="阴差阳错"><a class="header-anchor" href="#阴差阳错">¶</a>阴差阳错</h3><p>博主之前到这一步时，还保留了MIUI系统，刷ubuntu系统之前只进行了三清，重启进入ubuntu系统，一开始是正常的linux启动4只小企鹅（对应tegra-k1四个Cortex-A15），一条条messages滚过后，就悲剧了，卡在mount: mounting不动了，重刷了几次都是如此！4PDA论坛也有一个会员遇到同样的问题，然而大佬们并不鸟他…</p><p><img src="/561a0aca/4.jpg" alt="linux开机卡住的地方"></p><p>郁闷了几天，准备放弃，心想要是Linux整不了就刷个CN系统算了，查了查google，发现米板1可刷LineageOS-14，按照论坛的教程，先四清，刷lineageOS之前，需要合并MIUI的两个system分区成一个，合并分区后，成功刷入，配置了一下google全家桶，lineageOS居然该死的甜美。</p><p>emmm…没有用上原生linux还是不爽，再试试如何？又刷了一次ubuntu，重启，居然跳过之前卡住的mount: mounting的部分，成功进入ubuntu桌面，触屏可用，OTG插上键鼠可用，OK搞定</p><h3 id="mipad-mocha-合并分区教程-有删改"><a class="header-anchor" href="#mipad-mocha-合并分区教程-有删改">¶</a>MiPad Mocha 合并分区教程/有删改</h3><p><a href="http://www.miui.com/thread-7412054-1-1.html" target="_blank" rel="noopener">论坛原文</a><br>将MIUI系统分区合并至1.2GB的具体步骤：<br>1.下载 Repartition_MI_Pad_1_2GB_zardMi3.zip 和 Repartition_Stock-Partition_MI_Pad_zardMi3.zip (上文度云链接里有）<br>2.拷入你的小米平板根目录中；<br>3.清除Cache,Data,System和Dalvik Cache的数据。（重启到twrp选择&quot;wipe&quot;,勾选以下项后，滑动条，实现四清）<br><img src="/561a0aca/3.jpg" alt="multirom_twrp的四清勾选"><br>4.刷入Repartition_MI_Pad_1_2GB_zardMi3.zip<br>5.将 lineageOS-14刷入,若你想用google服务框架，在1步下载Gapps在此步刷入即可<br>6.重启至LineageOS系统<br>7.你可以使用Google PlayStore里的DiskInfo，System Partitions，或者Titanium Backup来确认你的系统一分区大小。（总大小是1.21GB，剩余空间是688MB）                   ##译者：这里我的数据是总大小1.29GB，剩余空间是733MB</p><h2 id="刷入linux4tegrar241-mrom"><a class="header-anchor" href="#刷入linux4tegrar241-mrom">¶</a>刷入Linux4TegraR241.mrom</h2><h3 id="multirom"><a class="header-anchor" href="#multirom">¶</a>MultiRom</h3><p>下载4PDA项目原文置顶链接的Google盘的&quot;02.05.2017 L4T R24.1&quot;<br>*注意：不要下03.12.2018版本的，这个版本我刷入过，触摸和OTG都不能用，开机只启动一个核心<br>拷贝该文件到平版根目录<br>重启到TWRP，点击右上角三条横线，进入整合到TWRP的MultiRom刷机界面，点击&quot;add&quot;<br>选择内部flash储存，如图：<br><img src="/561a0aca/11.jpg" alt><br>刷入，需要等待10分钟左右，成功刷入如图：<br>![](D:\ODG blog\<a href="http://oldgerman.github.io" target="_blank" rel="noopener">oldgerman.github.io</a>\source_posts\小米平板1-ubuntu系统-刷机篇\5.jpg)<br>重启，点击multirom多重引导界面出现的第二个系统即可启动linux：<br><img src="/561a0aca/6.jpg" alt="linux开机中"><br>等待进入ubuntu桌面即可，赶紧用OTG连接键鼠配置一下!</p><p><img src="/561a0aca/0.png" alt="成功进入Gnome"></p><h2 id="ubuntu系统-配置篇"><a class="header-anchor" href="#ubuntu系统-配置篇">¶</a><a href="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1566385494542&amp;di=3d3e792ff50969f51fc70a74cbc2cd1e&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201812%2F10%2F20181210095624_ndyab.png" target="_blank" rel="noopener">ubuntu系统_配置篇</a></h2>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
